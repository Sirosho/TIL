# Action
action은 React Router에서 데이터 변경(생성, 수정, 삭제)을 전담하는 함수이다. 데이터를 읽는 loader와 짝을 이루어 웹 애플리케이션의 데이터 흐름을 관리한다. 레스토랑에 비유하면, loader가 메뉴판을 보여주는 것이라면 action은 주문을 받아 요리를 만드는 것과 같다.




## `action`의 기본 사용법

`action`의 가장 기본적인 사용법은 **라우터 설정에 함수를 정의**하고, UI에서는 **`<Form>` 컴포넌트를 통해 해당 함수를 호출**하는 것이다.

1.  **`action` 함수 정의**: 라우터 설정 시 `action` 속성에 비동기 함수를 연결한다. 이 함수는 `request` 객체를 받아 `formData`에 접근하고, 데이터 처리 후에는 `redirect`를 통해 다른 페이지로 이동시킨다.

    ```jsx
    const router = createBrowserRouter([
      {
        path: '/blog/new',
        element: <NewPost />,
        action: async ({ request }) => {
          const formData = await request.formData();
          // 폼 데이터를 기반으로 새 포스트 생성
          await createPost({ 
            title: formData.get('title'),
            content: formData.get('content')
          });
          return redirect('/blog');
        }
      }
    ]);
    ```

2.  **`<Form>` 컴포넌트 사용**: `react-router-dom`의 `<Form>` 컴포넌트는 HTML `<form>`을 대체한다. `method` 속성으로 `POST`와 같은 HTTP 요청을 지정하며, `input`의 `name` 속성이 `formData`의 키가 된다.

    ```jsx
    import { Form } from 'react--router-dom';

    function NewPost() {
      return (
        <Form method="post">
          <input type="text" name="title" />
          <textarea name="content" />
          <button type="submit">포스트 작성</button>
        </Form>
      );
    }
    ```

<div style="margin-top:100px;"></div>

## `action`의 심화 활용

`action`은 단순 데이터 제출 외에도 다양한 패턴으로 활용될 수 있다.

  - **데이터 유효성 검사**: `action` 함수 내에서 데이터를 검증하고, 실패 시 `redirect` 대신 **에러 객체를 반환**한다. 이 값은 컴포넌트에서 `useActionData` 훅으로 받아 사용자에게 에러 메시지를 보여주는 데 사용된다.

  - **여러 종류의 Form 처리**: 하나의 `action` 함수가 여러 종류의 제출을 처리해야 할 경우, `<input type="hidden" name="intent" value="delete" />` 와 같이 **`intent` 필드**를 두어 구분한다. `action`에서는 `formData.get('intent')` 값에 따라 분기하여 다른 로직을 실행한다.



<div style="margin-top:100px;"></div>


## 안정적인 `action` 구현을 위한 주의사항

  - **상태 관리 및 UI 피드백**: `useNavigation` 훅을 사용하면 `action`이 실행 중인 상태(`navigation.state === 'submitting'`)를 알 수 있다. 이를 통해 버튼을 비활성화하거나 로딩 스피너를 표시하여 사용자 경험을 향상시킨다.

  - **데이터 검증**: 사용자 경험을 위해 클라이언트(`action` 내부)에서 1차 검증을 수행하더라도, 보안을 위해 **백엔드 서버에서도 반드시 동일한 검증**을 다시 수행해야 한다.

  - **에러 처리**: `fetch` 요청 등 실패할 수 있는 코드는 `try...catch` 블록으로 감싸 예기치 않은 오류가 발생했을 때 앱이 중단되지 않고, 사용자에게 에러 메시지를 보여줄 수 있도록 처리해야 한다.

-----

## 핵심 요약

  - `action`은 **데이터 변경(쓰기) 작업**을 처리하는 서버와 같은 함수이다.
  - `<Form>` 컴포넌트와 함께 사용하여 선언적으로 데이터 제출 로직을 구현한다.
  - **데이터 검증**, **로딩 상태 관리**, **에러 처리**는 안정적인 `action` 구현의 필수 요소이다.







<div style="margin-top:100px;"></div>



-----

# Form 컴포넌트란?

React Router의 **`<Form>` 컴포넌트**는 SPA(Single Page Application) 환경에 최적화된 데이터 제출을 위해 제공하는 특별한 컴포넌트이다. 기본 HTML `<form>` 태그와 달리, 페이지 전체를 새로고침하지 않고 현재 경로에 연결된 `action` 함수로 데이터를 전송하여 부드러운 사용자 경험을 제공한다.


<div style="margin-top:100px;"></div>


## `Form` 컴포넌트의 주요 특징

### 1\. SPA에 최적화된 데이터 제출

`<Form>`은 브라우저의 기본 동작을 자동으로 막아준다. 따라서 `e.preventDefault()`를 수동으로 호출할 필요가 없으며, 폼이 제출되면 React Router가 이를 가로채 클라이언트 사이드 라우팅을 통해 `action` 함수를 실행시킨다.

  - **`method="post"`**: 데이터를 요청의 본문(body)에 담아 전송한다.
  - **`method="get"`**: 데이터를 URL의 검색 파라미터(query string)로 변환하여 전송하며, `action` 대신 `loader`를 실행시킨다.

### 2\. 자동화된 상태 관리

`useNavigation` 훅과 연동하여 폼 제출의 전체 과정을 추적할 수 있다. `navigation.state`가 `'submitting'`인지 확인하여 `action`이 실행 중인 동안 버튼을 비활성화하거나 로딩 인디케이터를 표시하는 등 직관적인 UI 피드백 구현이 가능하다.

```jsx
import { Form, useNavigation } from 'react-router-dom';

function PostForm() {
  const navigation = useNavigation();
  const isSubmitting = navigation.state === 'submitting';

  return (
    <Form method="post">
      <button type="submit" disabled={isSubmitting}>
        {isSubmitting ? '저장 중...' : '저장하기'}
      </button>
    </Form>
  );
}
```

### 3\. 훅(Hook)과의 긴밀한 연동

`<Form>`은 React Router의 다른 훅들과 함께 사용될 때 강력한 시너지를 낸다.

  - **`useActionData`**: `action` 함수가 반환한 유효성 검사 에러나 서버 응답 메시지를 폼 내부에 직접 표시할 수 있다.
  - **`useSubmit`**: `<Form>`을 직접 제출하는 대신, `onChange` 이벤트에 반응하는 검색창이나 자동 저장 기능처럼 프로그래밍 방식의 제출을 구현할 때 사용된다.

-----


<div style="margin-top:100px;"></div>


## 주요 활용 패턴

  - **다중 액션 처리**: 하나의 페이지에 여러 `Form`이 있을 경우, `<input type="hidden" name="intent" value="delete" />` 와 같이 `intent` 값을 두어 하나의 `action` 함수가 어떤 `Form`에서 제출되었는지 구분하여 처리하도록 만들 수 있다.
  - **파일 업로드**: 파일 전송이 필요할 경우, `<Form>`에 `encType="multipart/form-data"` 속성을 추가해야 한다.

-----


<div style="margin-top:100px;"></div>

# Form 의 속성



## 1. 표준 속성 중 특별하게 동작하는 것들

이 속성들은 일반 HTML `<form>`에도 존재하지만, React Router의 `<Form>`에서는 클라이언트 사이드 라우팅과 연동하여 다르게 동작한다.

-   `method`
    -   폼 제출 시 `action` 함수에 전달될 `request` 객체의 HTTP 메서드를 결정한다 (`post`, `put`, `patch`, `delete`).
    -   `method="get"`으로 지정하면 `action` 대신 **`loader` 함수를 실행**시키며, 폼 데이터는 URL의 쿼리 파라미터로 변환된다. 검색 폼을 구현할 때 주로 사용한다.

-   `action`
    -   폼을 제출할 `action` 함수가 연결된 경로를 지정한다.
    -   이 속성을 생략하면, **현재 폼이 렌더링된 경로의 `action`**을 자동으로 타겟팅한다.
    -   `/other/route`처럼 다른 경로를 명시하면 해당 경로의 `action`을 실행시킬 수 있다.

-   `encType`
    -   폼 데이터가 서버로 제출될 때 인코딩되는 방식을 지정한다.
    -   특히 `input type="file"`을 사용하여 파일을 업로드할 때는 반드시 **`multipart/form-data`**로 설정해야 한다. 이렇게 해야 `action` 함수에서 `request.formData()`로 파일 데이터에 올바르게 접근할 수 있다.

---


<div style="margin-top:100px;"></div>


## 2. `<Form>` 컴포넌트에만 있는 고유 속성

이 속성들은 React Router가 SPA의 동작을 제어하기 위해 추가한 고유한 props이다.

-   `replace`
    -   `true`로 설정하면 폼 제출 후 새로운 페이지로 이동할 때, 브라우저 히스토리 스택에 새 항목을 추가(`push`)하는 대신 현재 항목을 교체(`replace`)한다.
    -   로그인 폼 제출 후 뒤로 가기 버튼을 눌렀을 때 다시 로그인 페이지로 돌아가는 것을 방지하고 싶을 때 유용하다.

-   `reloadDocument`
    -   `true`로 설정하면 React Router의 클라이언트 사이드 라우팅을 모두 무시하고, 전통적인 HTML `<form>`처럼 **페이지 전체를 새로고침**하여 서버로 요청을 보낸다.

-   `preventScrollReset`
    -   `true`로 설정하면 폼 제출 후 페이지가 이동되거나 데이터가 다시 로드될 때, 스크롤 위치가 최상단으로 초기화되는 것을 방지하고 현재 스크롤 위치를 유지한다.

---


<div style="margin-top:100px;"></div>


### 요약표

| 속성 (Attribute) | 설명 | 타입 |
| :--- | :--- | :--- |
| **`method`** | 요청 메서드 지정 (`get`은 `loader` 실행) | 표준 (동작 변경) |
| **`action`** | 제출할 `action`의 경로 지정 (생략 시 현재 경로) | 표준 (동작 변경) |
| **`encType`** | 파일 업로드 시 `multipart/form-data`로 지정 | 표준 (동작 변경) |
| **`replace`** | 브라우저 히스토리를 교체할지 여부 | **고유 속성** |
| **`reloadDocument`** | SPA 라우팅을 무시하고 페이지를 새로고침할지 여부 | **고유 속성** |
| **`preventScrollReset`** | 폼 제출 후 스크롤 위치를 유지할지 여부 | **고유 속성** |






## 핵심 요약

  - `<Form>` 컴포넌트는 페이지 새로고침 없는 **SPA 방식의 폼 제출**을 기본으로 한다.
  - `useNavigation` 훅을 통해 **로딩 상태를 자동으로 관리**하여 UI 피드백을 쉽게 구현할 수 있다.
  - `action` 함수와 자연스럽게 연동되며, `useActionData`나 `useSubmit` 같은 훅과 함께 사용하여 다양한 상호작용을 만든다.


  - React Router의 `<Form>` 컴포넌트는 표준 HTML `<form>`의 모든 속성을 지원하며, 그중 일부는 SPA(Single Page Application) 환경에 맞게 특별한 방식으로 동작한다. 또한, React Router에만 존재하는 고유한 속성(props)도 있다.

---




<div style="margin-top:100px;"></div>




