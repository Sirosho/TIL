# 🧷 SQL JOIN 정리.md

<div style="margin-top:80px;"></div>

## ✅ JOIN이란?

> 여러 테이블에서 데이터를 **연결(결합)**해서 하나의 결과로 보여주는 SQL 문법이다.

---
<div style="margin-top:80px;"></div>

## 📌 JOIN 종류 (이번 실습에서는 INNER JOIN 위주)

| 종류        | 설명                                                                 |
|-------------|----------------------------------------------------------------------|
| `INNER JOIN` | 양쪽 테이블 모두 일치하는 데이터만 가져옴                            |
| `LEFT JOIN`  | 왼쪽 테이블 기준으로 전부 가져오고, 오른쪽은 일치하는 것만           |
| `RIGHT JOIN` | 오른쪽 테이블 기준으로 전부 가져오고, 왼쪽은 일치하는 것만           |
| `FULL JOIN`  | 양쪽 테이블의 모든 행 (Oracle에서는 `FULL OUTER JOIN`)             |

---
<div style="margin-top:80px;"></div>

## ✅ 1. 테이블 생성

```sql
CREATE TABLE DEPARTMENTS (
    id   NUMBER PRIMARY KEY,
    name VARCHAR2(50) NOT NULL
);

CREATE TABLE EMPLOYEES (
    id      NUMBER PRIMARY KEY,
    name    VARCHAR2(50) NOT NULL,
    dept_id NUMBER
);
````

<div style="margin-top:80px;"></div>

## ✅ 2. 예시 데이터 삽입

```sql
-- 부서
INSERT INTO DEPARTMENTS VALUES (10, '기획팀');
INSERT INTO DEPARTMENTS VALUES (20, '개발팀');
INSERT INTO DEPARTMENTS VALUES (30, '디자인팀');

-- 사원
INSERT INTO EMPLOYEES VALUES (101, '김철수', 10);
INSERT INTO EMPLOYEES VALUES (102, '박영희', 20);
INSERT INTO EMPLOYEES VALUES (103, '이지은', 20);
INSERT INTO EMPLOYEES VALUES (104, '최민준', 30);
```

<div style="margin-top:80px;"></div>


## ✅ 3. 오라클 스타일 JOIN (Comma + WHERE)

```sql
SELECT E.ID, E.NAME, D.ID, D.NAME AS DEPT_NAME
FROM EMPLOYEES E, DEPARTMENTS D
WHERE E.DEPT_ID = D.ID;
```

> Oracle SQL 스타일 (ANSI 표준 이전 방식)


<div style="margin-top:80px;"></div>

## ✅ 4. 표준 SQL JOIN (INNER JOIN)

```sql
SELECT E.ID, E.NAME, D.ID, D.NAME AS DEPT_NAME
FROM EMPLOYEES E
JOIN DEPARTMENTS D
  ON E.DEPT_ID = D.ID;
```

> 가독성이 좋고 실무에서 많이 씀

<div style="margin-top:80px;"></div>

## ✅ 5. 게시글-회원 정보 JOIN

```sql
SELECT
    P.POST_ID,
    U.USERNAME,
    U.EMAIL,
    P.CONTENT
FROM POSTS P
INNER JOIN USERS U ON P.USER_ID = U.USER_ID;
```

> `POSTS`와 `USERS`를 `USER_ID` 기준으로 조인
> → 누가 어떤 글을 썼는지 조회 가능

<div style="margin-top:80px;"></div>

## ✅ 6. 해시태그와 게시물 JOIN

```sql
-- 방법 1: Oracle 방식
SELECT
    PT.POST_ID,
    H.TAG_NAME,
    P.CONTENT
FROM POST_TAGS PT, HASHTAGS H, POSTS P
WHERE PT.TAG_ID = H.TAG_ID
  AND PT.POST_ID = P.POST_ID
  AND H.TAG_ID = 1001
ORDER BY PT.POST_ID;

-- 방법 2: 표준 JOIN 방식
SELECT
    PT.POST_ID,
    H.TAG_NAME,
    P.CONTENT
FROM POST_TAGS PT
JOIN HASHTAGS H ON PT.TAG_ID = H.TAG_ID
JOIN POSTS P    ON PT.POST_ID = P.POST_ID
WHERE H.TAG_NAME LIKE '%일상%'
ORDER BY PT.POST_ID;
```

<div style="margin-top:80px;"></div>

## 🧠 JOIN 핵심 요약

| 구분        | 예시                             |
| --------- | ------------------------------ |
| 조인 기본     | `FROM A JOIN B ON A.컬럼 = B.컬럼` |
| 필터조건      | `WHERE 조건절`                    |
| 특정 컬럼만 출력 | `SELECT A.컬럼, B.컬럼 ...`        |
| 별칭 활용     | `FROM 테이블명 A JOIN 테이블명 B ...`  |
| 다중 JOIN   | 3개 이상의 테이블 조인 가능               |

<div style="margin-top:80px;"></div>

## ✅ 참고: 조인 순서 (실행 계획)

* `JOIN → WHERE → GROUP BY → HAVING → SELECT → ORDER BY`
* 조인 먼저, 필터는 그 이후!


<div style="margin-top:80px;"></div>


# 📘 외부조인 (OUTER JOIN) vs 내부조인 (INNER JOIN) 정리

<div style="margin-top:80px;"></div>

## ✅ JOIN 기본 개념 요약

| 종류                  | 설명                                 |
| ------------------- | ---------------------------------- |
| **INNER JOIN**      | 두 테이블 모두에 조건에 맞는 데이터가 있을 때만 결과에 포함 |
| **OUTER JOIN**      | 한쪽 테이블의 모든 데이터 + 매칭되는 데이터만 붙여서 출력  |
|  ↳ LEFT OUTER JOIN  | 왼쪽 테이블은 모두 출력 (없는 건 NULL)          |
|  ↳ RIGHT OUTER JOIN | 오른쪽 테이블은 모두 출력 (없는 건 NULL)         |
|  ↳ FULL OUTER JOIN  | 양쪽 모두 출력 (없는 건 NULL)               |

---

<div style="margin-top:80px;"></div>

## 🔍 집합 비유

| JOIN 종류              | 집합 개념              |
| -------------------- | ------------------ |
| **INNER JOIN**       | 🔵 교집합             |
| **LEFT OUTER JOIN**  | 🔵 + ⚪ 왼쪽 기준 합집합   |
| **RIGHT OUTER JOIN** | ⚪ + 🔵 오른쪽 기준 합집합  |
| **FULL OUTER JOIN**  | 🔵 + ⚪ + 🟡 완전 합집합 |

> 💡 조인 조건이 맞는 항목은 붙이고, 없는 쪽은 `NULL`로 채워짐

---

<div style="margin-top:80px;"></div>

## 🆚 표준 SQL 문법 vs 오라클 전용 문법

| JOIN 종류          | ✅ 표준 SQL 문법 (ANSI JOIN)         | ❌ 오라클 전용 문법 (`+`)  |
| ---------------- | ------------------------------- | ------------------ |
| LEFT OUTER JOIN  | `LEFT JOIN B ON A.key = B.key`  | `A.key = B.key(+)` |
| RIGHT OUTER JOIN | `RIGHT JOIN B ON A.key = B.key` | `A.key(+) = B.key` |
| FULL OUTER JOIN  | `FULL JOIN B ON A.key = B.key`  | ❌ 불가능 (지원 안 됨)     |

> 📌 `+`는 **데이터가 없어도 포함할 쪽에 붙인다**

---

<div style="margin-top:80px;"></div>

## 🔥 FULL OUTER JOIN을 오라클 구문으로 쓰고 싶다면?

```sql
SELECT ...
FROM A
LEFT JOIN B ON A.key = B.key

UNION

SELECT ...
FROM A
RIGHT JOIN B ON A.key = B.key;
```

---

<div style="margin-top:80px;"></div>

## 🧠 언제 INNER, OUTER JOIN을 쓰나?

| 사용 상황              | 추천 JOIN                   |
| ------------------ | ------------------------- |
| 조건에 맞는 데이터만 필요     | `INNER JOIN`              |
| 기준 테이블은 무조건 출력해야 함 | `LEFT JOIN`, `RIGHT JOIN` |
| 양쪽 모두 다 보여줘야 함     | `FULL OUTER JOIN`         |


<div style="margin-top:80px;"></div>

## NATURAL JOIN

두 테이블 간에 공통된 이름을 가진 컬럼을 기준으로 자동으로 조인하는 방식이다. 이 때 조인에 사용되는 공통 컬럼은 명시적으로 지정하지 않으며, 해당 컬럼에는 소유자를 지정하는 별칭(alias)을 사용할 수 없다.

```sql
-- USERS와 USER_PROFILES 테이블에 공통으로 존재하는 컬럼(예: USER_ID)을 기준으로 자동 조인한다.
-- 공통 컬럼인 USER_ID에는 별칭(U.USER_ID)을 사용할 수 없다.
SELECT
    USER_ID,
    U.USERNAME,
    U.EMAIL,
    UP.FULL_NAME,
    UP.BIO
FROM USERS U
NATURAL JOIN USER_PROFILES UP;
```

`NATURAL JOIN`은 `USING` 절을 사용하여 명시적으로 공통 컬럼을 지정하는 방식으로 대체할 수 있으며, 결과는 동일하다. `USING` 절은 `NATURAL JOIN`보다 조인 기준을 명확히 보여주는 장점이 있다.

<div style="margin-top:80px;"></div>

```sql
-- USING 절을 사용하여 조인할 컬럼(USER_ID)을 명시적으로 지정한다.
-- 이 역시 해당 컬럼에는 별칭을 붙이지 않는다.
SELECT
    USER_ID,
    U.USERNAME,
    U.EMAIL,
    UP.FULL_NAME,
    UP.BIO
FROM USERS U
JOIN USER_PROFILES UP
USING (USER_ID);
```

### **주의할 점**
*   `NATURAL JOIN`은 편리하지만, 의도치 않은 컬럼이 조인 조건에 포함될 위험이 있다. 두 테이블에 이름이 같은 컬럼이 여러 개 있다면 모두 조인 조건으로 사용되므로 예상과 다른 결과가 나올 수 있다. 따라서 실무에서는 조인 조건을 명확히 하는 `ON` 절을 사용하는 것이 권장된다.


<div style="margin-top:80px;"></div>

## SELF JOIN

하나의 테이블을 자기 자신과 조인하는 기법이다. 테이블에 별칭을 각각 부여하여 마치 두 개의 다른 테이블인 것처럼 사용한다. 주로 하나의 테이블 내에 계층적인 관계(예: 직원과 관리자, 부모 카테고리와 자식 카테고리)가 포함된 데이터를 조회할 때 사용한다.

```sql
-- USERS 테이블을 직원(U1)과 관리자(U2) 테이블로 간주하고 조인한다.
-- 직원의 MANAGER_ID와 관리자의 USER_ID를 연결한다.
-- LEFT JOIN을 사용하여 관리자가 없는 최상위 직원도 결과에 포함시킨다.
SELECT
    U1.USER_ID,
    U1.USERNAME,
    U1.MANAGER_ID,
    NVL(U2.USERNAME, '상사없음') AS MANAGER_USERNAME
FROM USERS U1
LEFT JOIN USERS U2
ON U1.MANAGER_ID = U2.USER_ID
ORDER BY U1.USER_ID;
```

### **문법적 특징**
*   `SELF JOIN`을 위해서는 반드시 테이블 별칭(Alias)을 사용해야 한다. 별칭이 없으면 어떤 테이블의 컬럼인지 구분할 수 없다.
*   조인 조건(예: `ON U1.MANAGER_ID = U2.USER_ID`)을 통해 테이블 내의 관계를 정의한다.


<div style="margin-top:80px;"></div>

## CROSS JOIN (카티션 곱)

조인 조건 없이 한 테이블의 모든 행을 다른 테이블의 모든 행과 각각 하나씩 모두 조합하는 방식이다. 결과 행의 수는 첫 번째 테이블의 행 수와 두 번째 테이블의 행 수를 곱한 값과 같다. 이를 카티션 곱(Cartesian Product)이라고 한다.

### **표준 문법 (ANSI)**
`CROSS JOIN` 키워드를 명시적으로 사용한다.

```sql
-- EMPLOYEES 테이블의 모든 행과 DEPARTMENTS 테이블의 모든 행을 조합한다.
SELECT *
FROM EMPLOYEES
CROSS JOIN DEPARTMENTS;
```

### **오라클 전용 문법**
`FROM` 절에 쉼표(`,`)로 테이블을 나열하고 `WHERE` 조건절을 생략하면 `CROSS JOIN`과 동일하게 동작한다.

```sql
-- 표준 문법의 CROSS JOIN과 동일한 결과를 반환하는 오라클 구문이다.
SELECT *
FROM EMPLOYEES, DEPARTMENTS;
```

<div style="margin-top:80px;"></div>

### **주의할 점**
*   `CROSS JOIN`은 데이터의 양을 기하급수적으로 증가시킨다. 대용량 테이블에 사용할 경우 시스템에 심각한 부하를 주거나 응답이 없을 수 있으므로, 반드시 필요한 경우에만 제한적으로 사용해야 한다.
*   `WHERE` 절에 조인 조건을 실수로 누락하면 의도치 않은 `CROSS JOIN`이 발생하여 성능 문제를 일으킬 수 있다.